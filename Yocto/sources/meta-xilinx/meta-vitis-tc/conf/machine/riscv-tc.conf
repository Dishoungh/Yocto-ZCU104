require conf/machine/include/machine-xilinx-qemu.inc
require conf/multilib.conf
require conf/machine/include/mbv/arch-riscv.inc
require conf/machine/include/baremetal-tc.conf

# In order to support additional extensions, enable binutils 2.43.1
BINUVERSION = "2.43%"

# Set defaults
# We don't know why pie is not supported, but when enabled results in:
#   .../riscv32-xilinx-elf/12.2.0/ld: -pie not supported
GCCPIE:riscv-tc = ""
GLIBCPIE:riscv-tc = ""
SECURITY_CFLAGS:remove:riscv-tc = "${SECURITY_PIE_CFLAGS}"
SECURITY_CFLAGS:pn-libgcc:riscv-tc = ""

# Define all of the multilibs supported by this configuration
MULTILIB_GLOBAL_VARIANTS = "${@extend_variants(d,'MULTILIBS','multilib')}"

# riscv 64-bit it's been requested to move to the medany memory model
TARGET_CFLAGS:append:libc-newlib:riscv64 = " -mcmodel=medany"

############# DEFAULT SET ##################
MULTILIBS  = ""

# This is used when you clear the generated below in order to run the
# riscv-convert.sh script.  Even though its a duplicate, do not
# remove.
#
# Base configuration
# CFLAGS:
DEFAULTTUNE = "rv32"

AVAILTUNES += "rv32"
TUNE_FEATURES:tune-rv32 = "rv 32 i"
PACKAGE_EXTRA_ARCHS:tune-rv32 = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32 = "lib"

############ GENERATED #############
# Multilibs defined in recipes-devtools/gcc/gcc-xilinx-standalone-multilib.inc
# Everything below is generated by riscv-convert.sh
MULTILIBS  = ""
MULTILIBS += "multilib:librv32i"
MULTILIBS += "multilib:librv32ib"
MULTILIBS += "multilib:librv32ic"
MULTILIBS += "multilib:librv32icb"
MULTILIBS += "multilib:librv32im"
MULTILIBS += "multilib:librv32imb"
MULTILIBS += "multilib:librv32imc"
MULTILIBS += "multilib:librv32imcb"
MULTILIBS += "multilib:librv32imac"
MULTILIBS += "multilib:librv32imac_zicsr_zifencei"
MULTILIBS += "multilib:librv32imf_zicsr"
MULTILIBS += "multilib:librv32imfc_zicsr"
MULTILIBS += "multilib:librv32imafc_zicsr"
MULTILIBS += "multilib:librv32imfdc_zicsr"
MULTILIBS += "multilib:librv64i"
MULTILIBS += "multilib:librv64ic"
MULTILIBS += "multilib:librv64im"
MULTILIBS += "multilib:librv64imc"
MULTILIBS += "multilib:librv64imac"
MULTILIBS += "multilib:librv64imf_zicsr"
MULTILIBS += "multilib:librv64imfc_zicsr"
MULTILIBS += "multilib:librv64imafc_zicsr"
MULTILIBS += "multilib:librv64imfdc_zicsr"

# Base configuration
# CFLAGS:
DEFAULTTUNE = "rv32"

AVAILTUNES += "rv32"
TUNE_FEATURES:tune-rv32 = "rv 32 i"
PACKAGE_EXTRA_ARCHS:tune-rv32 = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32 = "lib"


# rv32i/ilp32
# CFLAGS: -march=rv32i -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32i = "rv32i"

AVAILTUNES += "rv32i"
TUNE_FEATURES:tune-rv32i = "${@mbv.tune.riscv_isa_to_tune("rv32i")}"
PACKAGE_EXTRA_ARCHS:tune-rv32i = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32i = "lib/rv32i/ilp32"


# rv32ib/ilp32
# CFLAGS: -march=rv32ib -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32ib = "rv32ib"

AVAILTUNES += "rv32ib"
TUNE_FEATURES:tune-rv32ib = "${@mbv.tune.riscv_isa_to_tune("rv32ib")}"
PACKAGE_EXTRA_ARCHS:tune-rv32ib = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32ib = "lib/rv32ib/ilp32"


# rv32ic/ilp32
# CFLAGS: -march=rv32ic -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32ic = "rv32ic"

AVAILTUNES += "rv32ic"
TUNE_FEATURES:tune-rv32ic = "${@mbv.tune.riscv_isa_to_tune("rv32ic")}"
PACKAGE_EXTRA_ARCHS:tune-rv32ic = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32ic = "lib/rv32ic/ilp32"


# rv32icb/ilp32
# CFLAGS: -march=rv32icb -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32icb = "rv32icb"

AVAILTUNES += "rv32icb"
TUNE_FEATURES:tune-rv32icb = "${@mbv.tune.riscv_isa_to_tune("rv32icb")}"
PACKAGE_EXTRA_ARCHS:tune-rv32icb = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32icb = "lib/rv32icb/ilp32"


# rv32im/ilp32
# CFLAGS: -march=rv32im -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32im = "rv32im"

AVAILTUNES += "rv32im"
TUNE_FEATURES:tune-rv32im = "${@mbv.tune.riscv_isa_to_tune("rv32im")}"
PACKAGE_EXTRA_ARCHS:tune-rv32im = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32im = "lib/rv32im/ilp32"


# rv32imb/ilp32
# CFLAGS: -march=rv32imb -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32imb = "rv32imb"

AVAILTUNES += "rv32imb"
TUNE_FEATURES:tune-rv32imb = "${@mbv.tune.riscv_isa_to_tune("rv32imb")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imb = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imb = "lib/rv32imb/ilp32"


# rv32imc/ilp32
# CFLAGS: -march=rv32imc -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32imc = "rv32imc"

AVAILTUNES += "rv32imc"
TUNE_FEATURES:tune-rv32imc = "${@mbv.tune.riscv_isa_to_tune("rv32imc")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imc = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imc = "lib/rv32imc/ilp32"


# rv32imcb/ilp32
# CFLAGS: -march=rv32imcb -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32imcb = "rv32imcb"

AVAILTUNES += "rv32imcb"
TUNE_FEATURES:tune-rv32imcb = "${@mbv.tune.riscv_isa_to_tune("rv32imcb")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imcb = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imcb = "lib/rv32imcb/ilp32"


# rv32imac/ilp32
# CFLAGS: -march=rv32imac -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32imac = "rv32imac"

AVAILTUNES += "rv32imac"
TUNE_FEATURES:tune-rv32imac = "${@mbv.tune.riscv_isa_to_tune("rv32imac")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imac = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imac = "lib/rv32imac/ilp32"


# rv32imac_zicsr_zifencei/ilp32
# CFLAGS: -march=rv32imac_zicsr_zifencei -mabi=ilp32
DEFAULTTUNE:virtclass-multilib-librv32imac_zicsr_zifencei = "rv32imac_zicsr_zifencei"

AVAILTUNES += "rv32imac_zicsr_zifencei"
TUNE_FEATURES:tune-rv32imac_zicsr_zifencei = "${@mbv.tune.riscv_isa_to_tune("rv32imac_zicsr_zifencei")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imac_zicsr_zifencei = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imac_zicsr_zifencei = "lib/rv32imac_zicsr_zifencei/ilp32"


# rv32imf_zicsr/ilp32f
# CFLAGS: -march=rv32imf_zicsr -mabi=ilp32f
DEFAULTTUNE:virtclass-multilib-librv32imf_zicsr = "rv32imf_zicsr"

AVAILTUNES += "rv32imf_zicsr"
TUNE_FEATURES:tune-rv32imf_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv32imf_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imf_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imf_zicsr = "lib/rv32imf_zicsr/ilp32f"


# rv32imfc_zicsr/ilp32f
# CFLAGS: -march=rv32imfc_zicsr -mabi=ilp32f
DEFAULTTUNE:virtclass-multilib-librv32imfc_zicsr = "rv32imfc_zicsr"

AVAILTUNES += "rv32imfc_zicsr"
TUNE_FEATURES:tune-rv32imfc_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv32imfc_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imfc_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imfc_zicsr = "lib/rv32imfc_zicsr/ilp32f"


# rv32imafc_zicsr/ilp32f
# CFLAGS: -march=rv32imafc_zicsr -mabi=ilp32f
DEFAULTTUNE:virtclass-multilib-librv32imafc_zicsr = "rv32imafc_zicsr"

AVAILTUNES += "rv32imafc_zicsr"
TUNE_FEATURES:tune-rv32imafc_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv32imafc_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imafc_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imafc_zicsr = "lib/rv32imafc_zicsr/ilp32f"


# rv32imfdc_zicsr/ilp32d
# CFLAGS: -march=rv32imfdc_zicsr -mabi=ilp32d
DEFAULTTUNE:virtclass-multilib-librv32imfdc_zicsr = "rv32imfdc_zicsr"

AVAILTUNES += "rv32imfdc_zicsr"
TUNE_FEATURES:tune-rv32imfdc_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv32imfdc_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv32imfdc_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv32imfdc_zicsr = "lib/rv32imfdc_zicsr/ilp32d"


# rv64i/lp64
# CFLAGS: -march=rv64i -mabi=lp64
DEFAULTTUNE:virtclass-multilib-librv64i = "rv64i"

AVAILTUNES += "rv64i"
TUNE_FEATURES:tune-rv64i = "${@mbv.tune.riscv_isa_to_tune("rv64i")}"
PACKAGE_EXTRA_ARCHS:tune-rv64i = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64i = "lib/rv64i/lp64"


# rv64ic/lp64
# CFLAGS: -march=rv64ic -mabi=lp64
DEFAULTTUNE:virtclass-multilib-librv64ic = "rv64ic"

AVAILTUNES += "rv64ic"
TUNE_FEATURES:tune-rv64ic = "${@mbv.tune.riscv_isa_to_tune("rv64ic")}"
PACKAGE_EXTRA_ARCHS:tune-rv64ic = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64ic = "lib/rv64ic/lp64"


# rv64im/lp64
# CFLAGS: -march=rv64im -mabi=lp64
DEFAULTTUNE:virtclass-multilib-librv64im = "rv64im"

AVAILTUNES += "rv64im"
TUNE_FEATURES:tune-rv64im = "${@mbv.tune.riscv_isa_to_tune("rv64im")}"
PACKAGE_EXTRA_ARCHS:tune-rv64im = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64im = "lib/rv64im/lp64"


# rv64imc/lp64
# CFLAGS: -march=rv64imc -mabi=lp64
DEFAULTTUNE:virtclass-multilib-librv64imc = "rv64imc"

AVAILTUNES += "rv64imc"
TUNE_FEATURES:tune-rv64imc = "${@mbv.tune.riscv_isa_to_tune("rv64imc")}"
PACKAGE_EXTRA_ARCHS:tune-rv64imc = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64imc = "lib/rv64imc/lp64"


# rv64imac/lp64
# CFLAGS: -march=rv64imac -mabi=lp64
DEFAULTTUNE:virtclass-multilib-librv64imac = "rv64imac"

AVAILTUNES += "rv64imac"
TUNE_FEATURES:tune-rv64imac = "${@mbv.tune.riscv_isa_to_tune("rv64imac")}"
PACKAGE_EXTRA_ARCHS:tune-rv64imac = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64imac = "lib/rv64imac/lp64"


# rv64imf_zicsr/lp64f
# CFLAGS: -march=rv64imf_zicsr -mabi=lp64f
DEFAULTTUNE:virtclass-multilib-librv64imf_zicsr = "rv64imf_zicsr"

AVAILTUNES += "rv64imf_zicsr"
TUNE_FEATURES:tune-rv64imf_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv64imf_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv64imf_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64imf_zicsr = "lib/rv64imf_zicsr/lp64f"


# rv64imfc_zicsr/lp64f
# CFLAGS: -march=rv64imfc_zicsr -mabi=lp64f
DEFAULTTUNE:virtclass-multilib-librv64imfc_zicsr = "rv64imfc_zicsr"

AVAILTUNES += "rv64imfc_zicsr"
TUNE_FEATURES:tune-rv64imfc_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv64imfc_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv64imfc_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64imfc_zicsr = "lib/rv64imfc_zicsr/lp64f"


# rv64imafc_zicsr/lp64f
# CFLAGS: -march=rv64imafc_zicsr -mabi=lp64f
DEFAULTTUNE:virtclass-multilib-librv64imafc_zicsr = "rv64imafc_zicsr"

AVAILTUNES += "rv64imafc_zicsr"
TUNE_FEATURES:tune-rv64imafc_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv64imafc_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv64imafc_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64imafc_zicsr = "lib/rv64imafc_zicsr/lp64f"


# rv64imfdc_zicsr/lp64d
# CFLAGS: -march=rv64imfdc_zicsr -mabi=lp64d
DEFAULTTUNE:virtclass-multilib-librv64imfdc_zicsr = "rv64imfdc_zicsr"

AVAILTUNES += "rv64imfdc_zicsr"
TUNE_FEATURES:tune-rv64imfdc_zicsr = "${@mbv.tune.riscv_isa_to_tune("rv64imfdc_zicsr")}"
PACKAGE_EXTRA_ARCHS:tune-rv64imfdc_zicsr = "${TUNE_RISCV_PKGARCH}"
BASE_LIB:tune-rv64imfdc_zicsr = "lib/rv64imfdc_zicsr/lp64d"
